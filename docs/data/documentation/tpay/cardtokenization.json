{"kind":"article","topicSections":[{"title":"Classes","anchor":"Classes","identifiers":["doc:\/\/com.tpay.sdk\/documentation\/Tpay\/AddCard\/Sheet"]}],"metadata":{"modules":[{"name":"Tpay"}],"roleHeading":"API Collection","role":"collectionGroup","title":"Card tokenization"},"schemaVersion":{"minor":3,"major":0,"patch":0},"primaryContentSections":[{"kind":"content","content":[{"level":2,"text":"Overview","type":"heading","anchor":"Overview"},{"inlineContent":[{"type":"text","text":"The Tpay SDK provides a way to register a credit card without performing a payment transaction, so a users can define their cards for future OneClick payments."}],"type":"paragraph"},{"level":2,"text":"AddCard sheet","type":"heading","anchor":"AddCard-sheet"},{"inlineContent":[{"type":"text","text":"The "},{"isActive":true,"type":"reference","identifier":"doc:\/\/com.tpay.sdk\/documentation\/Tpay\/AddCard\/Sheet"},{"type":"text","text":" is designed to guide the user through the card tokenization process. Sheet is presented in a modal style, providing a focused and intuitive interaction. The class interacts with the provided "},{"isActive":true,"type":"reference","identifier":"doc:\/\/com.tpay.sdk\/documentation\/Tpay\/AddCardDelegate"},{"type":"text","text":" to notify about tokenization events."}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"To create an instance of the "},{"type":"codeVoice","code":"Sheet"},{"type":"text","text":" class, initialize it with a "},{"type":"codeVoice","code":"Payer"},{"type":"text","text":" object and an optional "},{"type":"codeVoice","code":"AddCardDelegate"},{"type":"text","text":":"}],"type":"paragraph"},{"syntax":"swift","code":["let addCardSheet = AddCard.Sheet(payer: payer, delegate: delegate)"],"type":"codeListing"},{"inlineContent":[{"type":"text","text":"Use the "},{"type":"reference","identifier":"doc:\/\/com.tpay.sdk\/documentation\/Tpay\/AddCard\/Sheet\/present(from:)","isActive":true},{"type":"text","text":" method to present the sheet from a view controller:"}],"type":"paragraph"},{"syntax":"swift","code":["do {","    try addCardSheet.present(from: presentingViewController)","} catch {","    \/\/ Handle configuration errors or other exceptions","}"],"type":"codeListing"},{"inlineContent":[{"type":"text","text":"To dismiss the sheet manually, call the "},{"code":"dismiss()","type":"codeVoice"},{"type":"text","text":" method:"}],"type":"paragraph"},{"syntax":"swift","code":["addCardSheet.dismiss()"],"type":"codeListing"},{"level":3,"text":"SwiftUI way","type":"heading","anchor":"SwiftUI-way"},{"syntax":"swift","code":["struct ContentView: View {","    @State private var isTokenizationSheetPresented = false","","    var body: some View {","        Button(\"Add Card\") {","            isTokenizationSheetPresented.toggle()","        }","        .presentCardTokenizationSheet(isPresented: $isTokenizationSheetPresented) {","            \/\/ Handle card tokenization completed","        } onTokenizationCancelled: {","            \/\/ Handle card tokenization cancelled","        } onErrorOccured: { error in","            \/\/ Handle tokenization error","        }","    }","}"],"type":"codeListing"},{"level":2,"text":"Headless Payment","type":"heading","anchor":"Headless-Payment"},{"inlineContent":[{"text":"Tpay SDK allows you to make payment without any predefined screen.","type":"text"},{"text":" ","type":"text"},{"text":"To do so use ","type":"text"},{"code":"Tpay.Headless.Models.Card","type":"codeVoice"},{"text":" class.","type":"text"}],"type":"paragraph"},{"syntax":"swift","code":["do {","    try Headless.invokePayment(","        for: SingleTransaction(","            amount: 250,","            description: \"test\",","            hiddenDescription: \"hidden message\",","            payerContext: PayerContext(","                payer: Payer(","                    name: \"Test\",","                    email: \"email@address.com\",","                ),","            ),","        ),","        using: chosenPaymentChannel,","        with: Tpay.Headless.Models.Card(","            number: \"4056 2178 4359 7258\",","            expiryDate: Headless.Models.Card.ExpiryDate(month: 12, year: 35),","            securityCode: \"123\",","            shouldTokenize: false,","        )","    ) { result in","        switch result {","        case .success(let paymentResult):","            \/\/ Handle payment result","        case .failure(let error):","            \/\/ Handle payment error","        }","    }","} catch {","    \/\/ Handle invocation errors or other exceptions","}"],"type":"codeListing"},{"type":"aside","style":"note","name":"Note","content":[{"inlineContent":[{"type":"text","text":"[!Warning]"},{"type":"text","text":" "},{"type":"text","text":"If "},{"type":"codeVoice","code":"paymentResult"},{"type":"text","text":" returns "},{"type":"codeVoice","code":"continueUrl"},{"type":"text","text":", you have to handle it"},{"type":"text","text":" "},{"type":"text","text":"and redirect user to it in order to complete the payment."}],"type":"paragraph"}]},{"type":"aside","style":"note","name":"Note","content":[{"inlineContent":[{"type":"text","text":"[!Warning]"},{"type":"text","text":" "},{"type":"text","text":"If "},{"type":"codeVoice","code":"paymentResult"},{"type":"text","text":" returns "},{"type":"codeVoice","code":"paid"},{"type":"text","text":" in "},{"type":"codeVoice","code":"status"},{"type":"text","text":","},{"type":"text","text":" "},{"type":"text","text":"it means that transaction has been paid automatically during creation."}],"type":"paragraph"}]},{"type":"aside","style":"note","name":"Note","content":[{"type":"paragraph","inlineContent":[{"text":"[!Warning]","type":"text"},{"text":" ","type":"text"},{"text":"Generated card token will be sent to ","type":"text"},{"code":"notificationUrl","type":"codeVoice"},{"text":" specified in the notifications callbacks.","type":"text"}]}]},{"level":4,"text":"Tokenization","type":"heading","anchor":"Tokenization"},{"inlineContent":[{"type":"text","text":"You can also Opt-in to generate a credit card token for future payments"},{"type":"text","text":" "},{"type":"text","text":"if you want to let users pay for transactions with previously used card."},{"type":"text","text":" "},{"type":"text","text":"To do so, in "},{"type":"codeVoice","code":"Tpay.Headless.Models.Card"},{"type":"text","text":" class, set the "},{"type":"codeVoice","code":"shouldTokenize"},{"type":"text","text":" to true."}],"type":"paragraph"},{"syntax":"swift","code":["with: Tpay.Headless.Models.Card(","    number: \"4056 2178 4359 7258\",","    expiryDate: Headless.Models.Card.ExpiryDate(month: 12, year: 35),","    securityCode: \"123\",","    shouldTokenize: true,",")"],"type":"codeListing"},{"inlineContent":[{"text":"If you already have a credit card token, you can then set up token payment omitting credit card","type":"text"},{"text":" ","type":"text"},{"text":"info.","type":"text"},{"text":" ","type":"text"},{"text":"To do so, use ","type":"text"},{"code":"Tpay.Headless.Models.CardToken","type":"codeVoice"},{"text":" class instead of ","type":"text"},{"code":"Tpay.Headless.Models.Card","type":"codeVoice"},{"text":" one.","type":"text"}],"type":"paragraph"},{"syntax":"swift","code":["do {","    try Headless.invokePayment(","        for: SingleTransaction(","            amount: 250,","            description: \"test\",","            hiddenDescription: \"hidden message\",","            payerContext: PayerContext(","                payer: Payer(","                    name: \"Test\",","                    email: \"email@address.com\",","                ),","            ),","        ),","        using: chosenPaymentChannel,","        with: Tpay.Headless.Models.CardToken(","            token: \"saved_card_token\",","            cardTail: \"1234\",","            brand: CardToken.Brand.visa,","        )","    ) { result in","        switch result {","        case .success(let paymentResult):","            \/\/ Handle payment result","        case .failure(let error):","            \/\/ Handle payment error","        }","    }","} catch {","    \/\/ Handle invocation errors or other exceptions","}"],"type":"codeListing"},{"type":"aside","style":"note","name":"Note","content":[{"inlineContent":[{"text":"[!Warning]","type":"text"},{"text":" ","type":"text"},{"text":"For recurring payments, you can simply use created token in the haedless payments","type":"text"},{"text":" ","type":"text"},{"text":"to make transaction without need of user interaction.","type":"text"}],"type":"paragraph"}]}]}],"seeAlsoSections":[{"title":"Use cases","generated":true,"anchor":"Use-cases","identifiers":["doc:\/\/com.tpay.sdk\/documentation\/Tpay\/Payment","doc:\/\/com.tpay.sdk\/documentation\/Tpay\/AutomaticPayments"]}],"variants":[{"paths":["\/documentation\/tpay\/cardtokenization"],"traits":[{"interfaceLanguage":"swift"}]},{"paths":["\/documentation\/tpay\/cardtokenization"],"traits":[{"interfaceLanguage":"occ"}]}],"sections":[],"hierarchy":{"paths":[["doc:\/\/com.tpay.sdk\/documentation\/Tpay"]]},"abstract":[{"type":"text","text":"Saving credit card details for future purchases."}],"identifier":{"interfaceLanguage":"swift","url":"doc:\/\/com.tpay.sdk\/documentation\/Tpay\/CardTokenization"},"references":{"doc://com.tpay.sdk/documentation/Tpay/AddCard/Sheet/present(from:)":{"fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"present"},{"kind":"text","text":"("},{"kind":"externalParam","text":"from"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"UIViewController","preciseIdentifier":"c:objc(cs)UIViewController"},{"kind":"text","text":") "},{"kind":"keyword","text":"throws"}],"url":"\/documentation\/tpay\/addcard\/sheet\/present(from:)","role":"symbol","abstract":[{"type":"text","text":"Presents the sheet from a specified view controller."}],"type":"topic","kind":"symbol","identifier":"doc:\/\/com.tpay.sdk\/documentation\/Tpay\/AddCard\/Sheet\/present(from:)","title":"present(from:)"},"doc://com.tpay.sdk/documentation/Tpay/AddCardDelegate":{"type":"topic","kind":"symbol","url":"\/documentation\/tpay\/addcarddelegate","abstract":[{"type":"text","text":"The "},{"type":"codeVoice","code":"AddCardDelegate"},{"type":"text","text":" protocol defines the methods that a delegate should implement to handle events related to card tokenization."}],"fragments":[{"kind":"keyword","text":"protocol"},{"kind":"text","text":" "},{"kind":"identifier","text":"AddCardDelegate"}],"identifier":"doc:\/\/com.tpay.sdk\/documentation\/Tpay\/AddCardDelegate","navigatorTitle":[{"kind":"identifier","text":"AddCardDelegate"}],"title":"AddCardDelegate","role":"symbol"},"doc://com.tpay.sdk/documentation/Tpay":{"abstract":[],"type":"topic","kind":"symbol","title":"Tpay","identifier":"doc:\/\/com.tpay.sdk\/documentation\/Tpay","url":"\/documentation\/tpay","role":"collection"},"doc://com.tpay.sdk/documentation/Tpay/AddCard/Sheet":{"role":"symbol","fragments":[{"text":"class","kind":"keyword"},{"text":" ","kind":"text"},{"text":"Sheet","kind":"identifier"}],"navigatorTitle":[{"kind":"identifier","text":"Sheet"}],"abstract":[{"code":"AddCard.Sheet","type":"codeVoice"},{"text":" is a component that provides a user interface for adding a new card for future payment. It is designed to be presented as a sheet within your application and facilitates the tokenization of credit card information for future transactions.","type":"text"}],"title":"AddCard.Sheet","kind":"symbol","identifier":"doc:\/\/com.tpay.sdk\/documentation\/Tpay\/AddCard\/Sheet","type":"topic","url":"\/documentation\/tpay\/addcard\/sheet"},"doc://com.tpay.sdk/documentation/Tpay/Payment":{"role":"article","title":"Payment","url":"\/documentation\/tpay\/payment","abstract":[{"text":"Creating and processing payment transactions.","type":"text"}],"identifier":"doc:\/\/com.tpay.sdk\/documentation\/Tpay\/Payment","kind":"article","type":"topic"},"doc://com.tpay.sdk/documentation/Tpay/AutomaticPayments":{"identifier":"doc:\/\/com.tpay.sdk\/documentation\/Tpay\/AutomaticPayments","abstract":[{"text":"Providing automatic payment methods for a specific payer.","type":"text"}],"type":"topic","role":"article","title":"Automatic payments","url":"\/documentation\/tpay\/automaticpayments","kind":"article"}},"variantOverrides":[{"patch":[{"path":"\/identifier\/interfaceLanguage","op":"replace","value":"occ"},{"path":"\/topicSections","op":"replace","value":null},{"path":"\/seeAlsoSections","op":"replace","value":[{"generated":true,"title":"Use cases","identifiers":["doc:\/\/com.tpay.sdk\/documentation\/Tpay\/Payment","doc:\/\/com.tpay.sdk\/documentation\/Tpay\/AutomaticPayments"],"anchor":"Use-cases"}]}],"traits":[{"interfaceLanguage":"occ"}]}]}