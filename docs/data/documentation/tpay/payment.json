{"seeAlsoSections":[{"generated":true,"title":"Use cases","anchor":"Use-cases","identifiers":["doc:\/\/com.tpay.sdk\/documentation\/Tpay\/CardTokenization","doc:\/\/com.tpay.sdk\/documentation\/Tpay\/AutomaticPayments"]}],"abstract":[{"text":"Creating and processing payment transactions.","type":"text"}],"metadata":{"title":"Payment","roleHeading":"API Collection","modules":[{"name":"Tpay"}],"role":"collectionGroup"},"primaryContentSections":[{"kind":"content","content":[{"text":"Create a transaction","level":2,"type":"heading","anchor":"Create-a-transaction"},{"inlineContent":[{"text":"You can create a transaction using the ","type":"text"},{"isActive":true,"identifier":"doc:\/\/com.tpay.sdk\/documentation\/Tpay\/SingleTransaction","type":"reference"},{"text":" struct specifying the transactionâ€™s amount and description.","type":"text"}],"type":"paragraph"},{"code":["let singleTransaction = SingleTransaction(amount: 50.0, description: \"Product Purchase\")"],"type":"codeListing","syntax":"swift"},{"text":"Payer context","level":3,"type":"heading","anchor":"Payer-context"},{"inlineContent":[{"type":"text","text":"The payer context provides information about the payer, including their personal details and automatic payment methods. You can pass it along with transaction details."}],"type":"paragraph"},{"code":["let payer = Payer(name: \"John Doe\", email: \"john@example.com\")","let payerContext = PayerContext(payer: payer, automaticPaymentMethods: nil)","let singleTransaction = SingleTransaction(amount: 50.0, description: \"Product Purchase\", payerContext: payerContext)"],"type":"codeListing","syntax":"swift"},{"name":"Note","content":[{"inlineContent":[{"text":"See ","type":"text"},{"type":"reference","identifier":"doc:\/\/com.tpay.sdk\/documentation\/Tpay\/AutomaticPaymentMethods","isActive":true},{"text":" page describing how to provide automatic payment methods for a specific payer.","type":"text"}],"type":"paragraph"}],"type":"aside","style":"note"},{"text":"Recursive transaction","level":3,"type":"heading","anchor":"Recursive-transaction"},{"inlineContent":[{"type":"text","text":"For recurring transactions, you shall create an instance of "},{"type":"reference","identifier":"doc:\/\/com.tpay.sdk\/documentation\/Tpay\/RecursiveTransaction","isActive":true},{"type":"text","text":" specifying recursion parameters such as the frequency, quantity, and expiry date."}],"type":"paragraph"},{"code":["let recursiveTransaction = RecursiveTransaction(wrapping: singleTransaction,","                                                frequency: .monthly,","                                                quantity: .count(5),","                                                expiryDate: futureDate)"],"type":"codeListing","syntax":"swift"},{"text":"Payment sheet","level":2,"type":"heading","anchor":"Payment-sheet"},{"type":"paragraph","inlineContent":[{"type":"text","text":"The "},{"type":"reference","identifier":"doc:\/\/com.tpay.sdk\/documentation\/Tpay\/Payment\/Sheet","isActive":true},{"type":"text","text":" is designed to guide the user through the payment process. Payment sheet is presented in a modal style, providing a focused and intuitive payment interaction. The class interacts with the provided "},{"type":"reference","identifier":"doc:\/\/com.tpay.sdk\/documentation\/Tpay\/PaymentDelegate","isActive":true},{"type":"text","text":" to notify about payment events."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"To create an instance of the "},{"code":"Sheet","type":"codeVoice"},{"type":"text","text":" class, initialize it with a "},{"code":"Transaction","type":"codeVoice"},{"type":"text","text":" object and an optional "},{"code":"PaymentDelegate","type":"codeVoice"},{"type":"text","text":":"}]},{"syntax":"swift","code":["let paymentSheet = Payment.Sheet(transaction: transaction, delegate: delegate)"],"type":"codeListing"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Use the "},{"type":"reference","identifier":"doc:\/\/com.tpay.sdk\/documentation\/Tpay\/Payment\/Sheet\/present(from:)","isActive":true},{"type":"text","text":" method to present the payment sheet from a view controller:"}]},{"syntax":"swift","code":["do {","    try paymentSheet.present(from: presentingViewController)","} catch {","    \/\/ Handle configuration errors or other exceptions","}"],"type":"codeListing"},{"type":"paragraph","inlineContent":[{"text":"To dismiss the payment sheet manually, call the ","type":"text"},{"type":"codeVoice","code":"dismiss()"},{"text":" method:","type":"text"}]},{"syntax":"swift","code":["paymentSheet.dismiss()"],"type":"codeListing"},{"level":3,"text":"SwiftUI way","type":"heading","anchor":"SwiftUI-way"},{"syntax":"swift","code":["struct ContentView: View {","    @State private var isPaymentSheetPresented = false","","    var body: some View {","        Button(\"Pay\") {","            isPaymentSheetPresented.toggle()","        }","        .presentPaymentSheet(for: transaction, isPresented: $isPaymentSheetPresented) { transactionId in","            \/\/ Handle payment completed","        } onPaymentCancelled: { transactionId in","            \/\/ Handle payment cancelled","        } onErrorOccured: { error in","            \/\/ Handle payment error","        }","    }","}"],"type":"codeListing"},{"level":2,"text":"Headless","type":"heading","anchor":"Headless"},{"inlineContent":[{"text":"An alternative method for incorporating payments into an application is available. This approach empowers developers to autonomously gather all necessary payer information, facilitating the invocation of methods to programmatically initiate and advance through payment transactions, all without relying on a dedicated user interface (Payment Sheet).","type":"text"}],"type":"paragraph"},{"inlineContent":[{"text":"Initially, retrieve the list of available payment channels:","type":"text"}],"type":"paragraph"},{"code":["Headless.getAvailablePaymentChannels { result in","    switch result {","    case .success(let paymentChannels):","        \/\/ Handle available payment channels","    case .failure(let error):","        \/\/ Handle error","    }","}"],"type":"codeListing","syntax":"swift"},{"inlineContent":[{"text":"Once you have the list of available payment channels, choose the desired channel and execute the relevant method with the appropriate arguments:","type":"text"}],"type":"paragraph"},{"code":["do {","    Headless.invokePayment(for: transaction, using: cardPaymentChannel, with: card) { result in","        switch result {","        case .success(let paymentResult):","            \/\/ Handle payment result","        case .failure(let error):","            \/\/ Handle error","        }","    }","} catch {","    \/\/ Handle invocation errors or other exceptions","}"],"type":"codeListing","syntax":"swift"},{"inlineContent":[{"type":"text","text":"After successful payment invocation, you can retrieve the current payment status using:"}],"type":"paragraph"},{"code":["Headless.getPaymentStatus(for: paymentResult.ongoingTransaction) { statusResult in","    switch statusResult {","    case .success(let paymentStatus):","        \/\/ Handle payment status","    case .failure(let statusError):","        \/\/ Handle status retrieval error","    }","}"],"type":"codeListing","syntax":"swift"},{"anchor":"Payment-WebView","type":"heading","level":2,"text":"Payment WebView"},{"inlineContent":[{"type":"text","text":"You can easily handle externally generated transactions with a WebView component."},{"type":"text","text":" "},{"type":"text","text":"In order to generate a tranaction, please follow "},{"type":"codeVoice","code":"Transactions"},{"type":"text","text":" section under "},{"type":"reference","identifier":"https:\/\/openapi.tpay.com","isActive":true},{"type":"text","text":"."}],"type":"paragraph"},{"code":["let transaction = ExternallyGeneratedTransaction(transactionPaymentUrl: transactionPaymentUrl,  \/\/ retrieved from POST \/transactions","                                                 onSuccessRedirectUrl: onSuccessUrl,            \/\/ must match the one sent on transaction create","                                                 onErrorRedirectUrl: onErrorUrl)                \/\/ must match the one sent on transaction create","","let paymentWebView = Payment.WebView(transaction: transaction, delegate: delegate)","do {","    try paymentWebView?.present(from: self)","} catch {","    \/\/ Handle configuration errors or other exceptions","}"],"type":"codeListing","syntax":"swift"}]}],"kind":"article","variants":[{"traits":[{"interfaceLanguage":"swift"}],"paths":["\/documentation\/tpay\/payment"]},{"traits":[{"interfaceLanguage":"occ"}],"paths":["\/documentation\/tpay\/payment"]}],"sections":[],"schemaVersion":{"major":0,"minor":3,"patch":0},"hierarchy":{"paths":[["doc:\/\/com.tpay.sdk\/documentation\/Tpay"]]},"topicSections":[{"anchor":"Topics","identifiers":["doc:\/\/com.tpay.sdk\/documentation\/Tpay\/Headless"]},{"anchor":"Classes","title":"Classes","identifiers":["doc:\/\/com.tpay.sdk\/documentation\/Tpay\/Payment\/Sheet","doc:\/\/com.tpay.sdk\/documentation\/Tpay\/Payment\/Button","doc:\/\/com.tpay.sdk\/documentation\/Tpay\/Payment\/WebView"]},{"anchor":"Protocols","title":"Protocols","identifiers":["doc:\/\/com.tpay.sdk\/documentation\/Tpay\/PaymentDelegate"]}],"identifier":{"url":"doc:\/\/com.tpay.sdk\/documentation\/Tpay\/Payment","interfaceLanguage":"swift"},"references":{"doc://com.tpay.sdk/documentation/Tpay/CardTokenization":{"type":"topic","role":"collectionGroup","title":"Card tokenization","url":"\/documentation\/tpay\/cardtokenization","identifier":"doc:\/\/com.tpay.sdk\/documentation\/Tpay\/CardTokenization","kind":"article","abstract":[{"type":"text","text":"Saving credit card details for future purchases."}]},"doc://com.tpay.sdk/documentation/Tpay/AutomaticPaymentMethods":{"kind":"symbol","role":"symbol","type":"topic","identifier":"doc:\/\/com.tpay.sdk\/documentation\/Tpay\/AutomaticPaymentMethods","fragments":[{"kind":"keyword","text":"struct"},{"kind":"text","text":" "},{"kind":"identifier","text":"AutomaticPaymentMethods"}],"url":"\/documentation\/tpay\/automaticpaymentmethods","abstract":[{"type":"text","text":"The "},{"code":"AutomaticPaymentMethods","type":"codeVoice"},{"type":"text","text":" struct represents a collection of automatic payment methods associated with a concrete payer."}],"navigatorTitle":[{"kind":"identifier","text":"AutomaticPaymentMethods"}],"title":"AutomaticPaymentMethods"},"doc://com.tpay.sdk/documentation/Tpay/Headless":{"title":"Headless","kind":"symbol","type":"topic","role":"symbol","url":"\/documentation\/tpay\/headless","abstract":[{"text":"The ","type":"text"},{"code":"Headless","type":"codeVoice"},{"text":" API provides functionality for performing headless (without using Payment Sheet) transactions and handling payment-related operations. Developers can use this API to create and manage transactions independently, catering to specific use cases or custom user interfaces.","type":"text"}],"navigatorTitle":[{"kind":"identifier","text":"Headless"}],"identifier":"doc:\/\/com.tpay.sdk\/documentation\/Tpay\/Headless","fragments":[{"kind":"keyword","text":"enum"},{"kind":"text","text":" "},{"kind":"identifier","text":"Headless"}]},"doc://com.tpay.sdk/documentation/Tpay/RecursiveTransaction":{"fragments":[{"text":"struct","kind":"keyword"},{"text":" ","kind":"text"},{"text":"RecursiveTransaction","kind":"identifier"}],"kind":"symbol","navigatorTitle":[{"text":"RecursiveTransaction","kind":"identifier"}],"title":"RecursiveTransaction","identifier":"doc:\/\/com.tpay.sdk\/documentation\/Tpay\/RecursiveTransaction","abstract":[{"type":"text","text":"The "},{"type":"codeVoice","code":"RecursiveTransaction"},{"type":"text","text":" struct represents a recursive transaction. It extends a specified transaction object with recursion parameters such as the frequency, quantity, and expiry date."}],"url":"\/documentation\/tpay\/recursivetransaction","type":"topic","role":"symbol"},"doc://com.tpay.sdk/documentation/Tpay/PaymentDelegate":{"navigatorTitle":[{"text":"PaymentDelegate","kind":"identifier"}],"type":"topic","title":"PaymentDelegate","kind":"symbol","identifier":"doc:\/\/com.tpay.sdk\/documentation\/Tpay\/PaymentDelegate","url":"\/documentation\/tpay\/paymentdelegate","abstract":[{"text":"The ","type":"text"},{"code":"PaymentDelegate","type":"codeVoice"},{"text":" protocol defines the methods that a delegate should implement to handle payment-related events.","type":"text"}],"role":"symbol","fragments":[{"text":"protocol","kind":"keyword"},{"text":" ","kind":"text"},{"text":"PaymentDelegate","kind":"identifier"}]},"https://openapi.tpay.com":{"url":"https:\/\/openapi.tpay.com","titleInlineContent":[{"text":"OpenAPI documentation","type":"text"}],"identifier":"https:\/\/openapi.tpay.com","title":"OpenAPI documentation","type":"link"},"doc://com.tpay.sdk/documentation/Tpay/SingleTransaction":{"identifier":"doc:\/\/com.tpay.sdk\/documentation\/Tpay\/SingleTransaction","navigatorTitle":[{"text":"SingleTransaction","kind":"identifier"}],"abstract":[{"text":"The ","type":"text"},{"code":"SingleTransaction","type":"codeVoice"},{"text":" struct represents a single transaction with associated properties such as the transaction amount, description, and payer context.","type":"text"}],"title":"SingleTransaction","kind":"symbol","type":"topic","url":"\/documentation\/tpay\/singletransaction","role":"symbol","fragments":[{"text":"struct","kind":"keyword"},{"text":" ","kind":"text"},{"text":"SingleTransaction","kind":"identifier"}]},"doc://com.tpay.sdk/documentation/Tpay/Payment/Sheet":{"kind":"symbol","url":"\/documentation\/tpay\/payment\/sheet","fragments":[{"text":"class","kind":"keyword"},{"text":" ","kind":"text"},{"text":"Sheet","kind":"identifier"}],"type":"topic","abstract":[{"type":"text","text":"The "},{"type":"codeVoice","code":"Payment.Sheet"},{"type":"text","text":" class provides a streamlined way to present payment transactions within your app."}],"title":"Payment.Sheet","identifier":"doc:\/\/com.tpay.sdk\/documentation\/Tpay\/Payment\/Sheet","navigatorTitle":[{"text":"Sheet","kind":"identifier"}],"role":"symbol"},"doc://com.tpay.sdk/documentation/Tpay":{"title":"Tpay","identifier":"doc:\/\/com.tpay.sdk\/documentation\/Tpay","url":"\/documentation\/tpay","kind":"symbol","type":"topic","abstract":[],"role":"collection"},"doc://com.tpay.sdk/documentation/Tpay/Payment/WebView":{"kind":"symbol","title":"Payment.WebView","navigatorTitle":[{"text":"WebView","kind":"identifier"}],"type":"topic","role":"symbol","identifier":"doc:\/\/com.tpay.sdk\/documentation\/Tpay\/Payment\/WebView","fragments":[{"text":"class","kind":"keyword"},{"text":" ","kind":"text"},{"text":"WebView","kind":"identifier"}],"abstract":[{"text":"The ","type":"text"},{"code":"WebView","type":"codeVoice"},{"text":" class provides functionality for presenting a web view for externally-generated transaction processing within the payment module.","type":"text"}],"url":"\/documentation\/tpay\/payment\/webview"},"doc://com.tpay.sdk/documentation/Tpay/Payment/Sheet/present(from:)":{"kind":"symbol","url":"\/documentation\/tpay\/payment\/sheet\/present(from:)","fragments":[{"text":"func","kind":"keyword"},{"text":" ","kind":"text"},{"text":"present","kind":"identifier"},{"text":"(","kind":"text"},{"text":"from","kind":"externalParam"},{"text":": ","kind":"text"},{"text":"UIViewController","preciseIdentifier":"c:objc(cs)UIViewController","kind":"typeIdentifier"},{"text":") ","kind":"text"},{"text":"throws","kind":"keyword"}],"type":"topic","abstract":[{"type":"text","text":"Presents the payment sheet from a specified view controller."}],"title":"present(from:)","identifier":"doc:\/\/com.tpay.sdk\/documentation\/Tpay\/Payment\/Sheet\/present(from:)","role":"symbol"},"doc://com.tpay.sdk/documentation/Tpay/Payment/Button":{"navigatorTitle":[{"kind":"identifier","text":"Button"}],"title":"Payment.Button","identifier":"doc:\/\/com.tpay.sdk\/documentation\/Tpay\/Payment\/Button","type":"topic","url":"\/documentation\/tpay\/payment\/button","role":"symbol","kind":"symbol","abstract":[{"type":"text","text":"The specialized UIButton designed to serve as an effortless entry point for invoking the payment sheet within your app."}],"fragments":[{"kind":"keyword","text":"class"},{"kind":"text","text":" "},{"kind":"identifier","text":"Button"}]},"doc://com.tpay.sdk/documentation/Tpay/AutomaticPayments":{"identifier":"doc:\/\/com.tpay.sdk\/documentation\/Tpay\/AutomaticPayments","role":"article","title":"Automatic payments","abstract":[{"text":"Providing automatic payment methods for a specific payer.","type":"text"}],"url":"\/documentation\/tpay\/automaticpayments","kind":"article","type":"topic"}},"variantOverrides":[{"traits":[{"interfaceLanguage":"occ"}],"patch":[{"op":"replace","path":"\/identifier\/interfaceLanguage","value":"occ"},{"op":"replace","path":"\/topicSections","value":null},{"op":"replace","path":"\/seeAlsoSections","value":[{"title":"Use cases","identifiers":["doc:\/\/com.tpay.sdk\/documentation\/Tpay\/CardTokenization","doc:\/\/com.tpay.sdk\/documentation\/Tpay\/AutomaticPayments"],"generated":true,"anchor":"Use-cases"}]}]}]}