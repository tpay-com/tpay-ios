{"metadata":{"roleHeading":"Article","modules":[{"name":"Tpay"}],"role":"article","title":"Payment"},"sections":[],"kind":"article","abstract":[{"type":"text","text":"Creating and processing payment transactions."}],"seeAlsoSections":[{"identifiers":["doc:\/\/com.tpay.sdk\/documentation\/Tpay\/CardTokenization","doc:\/\/com.tpay.sdk\/documentation\/Tpay\/AutomaticPayments"],"anchor":"Use-cases","title":"Use cases","generated":true}],"hierarchy":{"paths":[["doc:\/\/com.tpay.sdk\/documentation\/Tpay"]]},"primaryContentSections":[{"content":[{"text":"Create a transaction","anchor":"Create-a-transaction","type":"heading","level":2},{"inlineContent":[{"type":"text","text":"You can create a transaction using the "},{"type":"reference","identifier":"doc:\/\/com.tpay.sdk\/documentation\/Tpay\/SingleTransaction","isActive":true},{"type":"text","text":" struct specifying the transactionâ€™s amount and description."}],"type":"paragraph"},{"code":["let singleTransaction = SingleTransaction(amount: 50.0, description: \"Product Purchase\")"],"syntax":"swift","type":"codeListing"},{"text":"Payer context","anchor":"Payer-context","type":"heading","level":3},{"inlineContent":[{"type":"text","text":"The payer context provides information about the payer, including their personal details and automatic payment methods. You can pass it along with transaction details."}],"type":"paragraph"},{"code":["let payer = Payer(name: \"John Doe\", email: \"john@example.com\")","let payerContext = PayerContext(payer: payer, automaticPaymentMethods: nil)","let singleTransaction = SingleTransaction(amount: 50.0, description: \"Product Purchase\", payerContext: payerContext)"],"syntax":"swift","type":"codeListing"},{"name":"Note","style":"note","type":"aside","content":[{"inlineContent":[{"text":"See ","type":"text"},{"type":"reference","isActive":true,"identifier":"doc:\/\/com.tpay.sdk\/documentation\/Tpay\/AutomaticPaymentMethods"},{"text":" page describing how to provide automatic payment methods for a specific payer.","type":"text"}],"type":"paragraph"}]},{"text":"Recursive transaction","anchor":"Recursive-transaction","type":"heading","level":3},{"inlineContent":[{"text":"For recurring transactions, you shall create an instance of ","type":"text"},{"isActive":true,"type":"reference","identifier":"doc:\/\/com.tpay.sdk\/documentation\/Tpay\/RecursiveTransaction"},{"text":" specifying recursion parameters such as the frequency, quantity, and expiry date.","type":"text"}],"type":"paragraph"},{"code":["let recursiveTransaction = RecursiveTransaction(wrapping: singleTransaction,","                                                frequency: .monthly,","                                                quantity: .specific(5),","                                                expiryDate: futureDate)"],"syntax":"swift","type":"codeListing"},{"text":"Payment sheet","anchor":"Payment-sheet","type":"heading","level":2},{"inlineContent":[{"type":"text","text":"The "},{"type":"reference","identifier":"doc:\/\/com.tpay.sdk\/documentation\/Tpay\/Payment\/Sheet","isActive":true},{"type":"text","text":" is designed to guide the user through the payment process. Payment sheet is presented in a modal style, providing a focused and intuitive payment interaction. The class interacts with the provided "},{"type":"reference","identifier":"doc:\/\/com.tpay.sdk\/documentation\/Tpay\/PaymentDelegate","isActive":true},{"type":"text","text":" to notify about payment events."}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"To create an instance of the "},{"type":"codeVoice","code":"Sheet"},{"type":"text","text":" class, initialize it with a "},{"type":"codeVoice","code":"Transaction"},{"type":"text","text":" object and an optional "},{"type":"codeVoice","code":"PaymentDelegate"},{"type":"text","text":":"}],"type":"paragraph"},{"type":"codeListing","syntax":"swift","code":["let paymentSheet = Payment.Sheet(transaction: transaction, delegate: delegate)"]},{"inlineContent":[{"text":"Use the ","type":"text"},{"identifier":"doc:\/\/com.tpay.sdk\/documentation\/Tpay\/Payment\/Sheet\/present(from:)","isActive":true,"type":"reference"},{"text":" method to present the payment sheet from a view controller:","type":"text"}],"type":"paragraph"},{"type":"codeListing","syntax":"swift","code":["do {","    try paymentSheet.present(from: presentingViewController)","} catch {","    \/\/ Handle configuration errors or other exceptions","}"]},{"inlineContent":[{"type":"text","text":"To dismiss the payment sheet manually, call the "},{"type":"codeVoice","code":"dismiss()"},{"type":"text","text":" method:"}],"type":"paragraph"},{"type":"codeListing","syntax":"swift","code":["paymentSheet.dismiss()"]},{"level":3,"type":"heading","anchor":"SwiftUI-way","text":"SwiftUI way"},{"type":"codeListing","syntax":"swift","code":["struct ContentView: View {","    @State private var isPaymentSheetPresented = false","","    var body: some View {","        Button(\"Pay\") {","            isPaymentSheetPresented.toggle()","        }","        .presentPaymentSheet(for: transaction, isPresented: $isPaymentSheetPresented) { transactionId in","            \/\/ Handle payment completed","        } onPaymentCancelled: { transactionId in","            \/\/ Handle payment cancelled","        } onErrorOccured: { error in","            \/\/ Handle payment error","        }","    }","}"]},{"level":2,"type":"heading","anchor":"Payment-WebView","text":"Payment WebView"},{"inlineContent":[{"type":"text","text":"You can easily handle externally generated transactions with a WebView component."},{"type":"text","text":" "},{"type":"text","text":"In order to generate a tranaction, please follow "},{"type":"codeVoice","code":"Transactions"},{"type":"text","text":" section under "},{"identifier":"https:\/\/openapi.tpay.com","type":"reference","isActive":true},{"type":"text","text":"."}],"type":"paragraph"},{"syntax":"swift","code":["let transaction = ExternallyGeneratedTransaction(transactionPaymentUrl: transactionPaymentUrl,  \/\/ retrieved from POST \/transactions","                                                 onSuccessRedirectUrl: onSuccessUrl,            \/\/ must match the one sent on transaction create","                                                 onErrorRedirectUrl: onErrorUrl)                \/\/ must match the one sent on transaction create","","let paymentWebView = Payment.WebView(transaction: transaction, delegate: delegate)","do {","    try paymentWebView?.present(from: self)","} catch {","    \/\/ Handle configuration errors or other exceptions","}"],"type":"codeListing"},{"anchor":"Classes","text":"Classes","level":3,"type":"heading"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"identifier":"doc:\/\/com.tpay.sdk\/documentation\/Tpay\/Payment\/Sheet","isActive":true,"type":"reference"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"identifier":"doc:\/\/com.tpay.sdk\/documentation\/Tpay\/Payment\/Button","type":"reference","isActive":true}]}]},{"content":[{"type":"paragraph","inlineContent":[{"identifier":"doc:\/\/com.tpay.sdk\/documentation\/Tpay\/Payment\/WebView","type":"reference","isActive":true}]}]}],"type":"unorderedList"},{"anchor":"Protocols","text":"Protocols","level":3,"type":"heading"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"identifier":"doc:\/\/com.tpay.sdk\/documentation\/Tpay\/PaymentDelegate","isActive":true,"type":"reference"}]}]}],"type":"unorderedList"}],"kind":"content"}],"identifier":{"url":"doc:\/\/com.tpay.sdk\/documentation\/Tpay\/Payment","interfaceLanguage":"swift"},"schemaVersion":{"patch":0,"minor":3,"major":0},"variants":[{"traits":[{"interfaceLanguage":"swift"}],"paths":["\/documentation\/tpay\/payment"]},{"traits":[{"interfaceLanguage":"occ"}],"paths":["\/documentation\/tpay\/payment"]}],"references":{"doc://com.tpay.sdk/documentation/Tpay":{"abstract":[],"type":"topic","kind":"symbol","title":"Tpay","identifier":"doc:\/\/com.tpay.sdk\/documentation\/Tpay","url":"\/documentation\/tpay","role":"collection"},"https://openapi.tpay.com":{"url":"https:\/\/openapi.tpay.com","title":"OpenAPI documentation","identifier":"https:\/\/openapi.tpay.com","titleInlineContent":[{"text":"OpenAPI documentation","type":"text"}],"type":"link"},"doc://com.tpay.sdk/documentation/Tpay/PaymentDelegate":{"type":"topic","kind":"symbol","fragments":[{"text":"protocol","kind":"keyword"},{"text":" ","kind":"text"},{"text":"PaymentDelegate","kind":"identifier"}],"url":"\/documentation\/tpay\/paymentdelegate","identifier":"doc:\/\/com.tpay.sdk\/documentation\/Tpay\/PaymentDelegate","abstract":[{"type":"text","text":"The "},{"code":"PaymentDelegate","type":"codeVoice"},{"type":"text","text":" protocol defines the methods that a delegate should implement to handle payment-related events."}],"role":"symbol","navigatorTitle":[{"text":"PaymentDelegate","kind":"identifier"}],"title":"PaymentDelegate"},"doc://com.tpay.sdk/documentation/Tpay/AutomaticPaymentMethods":{"url":"\/documentation\/tpay\/automaticpaymentmethods","abstract":[{"text":"The ","type":"text"},{"type":"codeVoice","code":"AutomaticPaymentMethods"},{"text":" struct represents a collection of automatic payment methods associated with a concrete payer.","type":"text"}],"fragments":[{"text":"struct","kind":"keyword"},{"text":" ","kind":"text"},{"text":"AutomaticPaymentMethods","kind":"identifier"}],"kind":"symbol","navigatorTitle":[{"text":"AutomaticPaymentMethods","kind":"identifier"}],"type":"topic","title":"AutomaticPaymentMethods","role":"symbol","identifier":"doc:\/\/com.tpay.sdk\/documentation\/Tpay\/AutomaticPaymentMethods"},"doc://com.tpay.sdk/documentation/Tpay/Payment/Sheet":{"title":"Payment.Sheet","identifier":"doc:\/\/com.tpay.sdk\/documentation\/Tpay\/Payment\/Sheet","kind":"symbol","abstract":[{"type":"text","text":"The "},{"code":"Payment.Sheet","type":"codeVoice"},{"type":"text","text":" class provides a streamlined way to present payment transactions within your app."}],"type":"topic","url":"\/documentation\/tpay\/payment\/sheet","role":"symbol","navigatorTitle":[{"kind":"identifier","text":"Sheet"}],"fragments":[{"kind":"keyword","text":"class"},{"kind":"text","text":" "},{"kind":"identifier","text":"Sheet"}]},"doc://com.tpay.sdk/documentation/Tpay/RecursiveTransaction":{"type":"topic","navigatorTitle":[{"kind":"identifier","text":"RecursiveTransaction"}],"fragments":[{"kind":"keyword","text":"struct"},{"kind":"text","text":" "},{"kind":"identifier","text":"RecursiveTransaction"}],"title":"RecursiveTransaction","identifier":"doc:\/\/com.tpay.sdk\/documentation\/Tpay\/RecursiveTransaction","role":"symbol","url":"\/documentation\/tpay\/recursivetransaction","abstract":[{"type":"text","text":"The "},{"type":"codeVoice","code":"RecursiveTransaction"},{"type":"text","text":" struct represents a recursive transaction. It extends a specified transaction object with recursion parameters such as the frequency, quantity, and expiry date."}],"kind":"symbol"},"doc://com.tpay.sdk/documentation/Tpay/Payment/Sheet/present(from:)":{"identifier":"doc:\/\/com.tpay.sdk\/documentation\/Tpay\/Payment\/Sheet\/present(from:)","role":"symbol","fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"present"},{"kind":"text","text":"("},{"kind":"externalParam","text":"from"},{"kind":"text","text":": "},{"kind":"typeIdentifier","preciseIdentifier":"c:objc(cs)UIViewController","text":"UIViewController"},{"kind":"text","text":") "},{"kind":"keyword","text":"throws"}],"abstract":[{"type":"text","text":"Presents the payment sheet from a specified view controller."}],"url":"\/documentation\/tpay\/payment\/sheet\/present(from:)","title":"present(from:)","kind":"symbol","type":"topic"},"doc://com.tpay.sdk/documentation/Tpay/SingleTransaction":{"fragments":[{"text":"struct","kind":"keyword"},{"text":" ","kind":"text"},{"text":"SingleTransaction","kind":"identifier"}],"identifier":"doc:\/\/com.tpay.sdk\/documentation\/Tpay\/SingleTransaction","role":"symbol","type":"topic","abstract":[{"text":"The ","type":"text"},{"code":"SingleTransaction","type":"codeVoice"},{"text":" struct represents a single transaction with associated properties such as the transaction amount, description, and payer context.","type":"text"}],"kind":"symbol","title":"SingleTransaction","url":"\/documentation\/tpay\/singletransaction","navigatorTitle":[{"text":"SingleTransaction","kind":"identifier"}]},"doc://com.tpay.sdk/documentation/Tpay/Payment/WebView":{"identifier":"doc:\/\/com.tpay.sdk\/documentation\/Tpay\/Payment\/WebView","title":"Payment.WebView","kind":"symbol","role":"symbol","fragments":[{"kind":"keyword","text":"class"},{"kind":"text","text":" "},{"kind":"identifier","text":"WebView"}],"navigatorTitle":[{"kind":"identifier","text":"WebView"}],"abstract":[{"type":"text","text":"The "},{"type":"codeVoice","code":"WebView"},{"type":"text","text":" class provides functionality for presenting a web view for externally-generated transaction processing within the payment module."}],"type":"topic","url":"\/documentation\/tpay\/payment\/webview"},"doc://com.tpay.sdk/documentation/Tpay/AutomaticPayments":{"identifier":"doc:\/\/com.tpay.sdk\/documentation\/Tpay\/AutomaticPayments","abstract":[{"text":"Providing automatic payment methods for a specific payer.","type":"text"}],"type":"topic","role":"article","title":"Automatic payments","url":"\/documentation\/tpay\/automaticpayments","kind":"article"},"doc://com.tpay.sdk/documentation/Tpay/Payment/Button":{"fragments":[{"text":"class","kind":"keyword"},{"text":" ","kind":"text"},{"text":"Button","kind":"identifier"}],"title":"Payment.Button","role":"symbol","url":"\/documentation\/tpay\/payment\/button","kind":"symbol","type":"topic","abstract":[{"text":"The specialized UIButton designed to serve as an effortless entry point for invoking the payment sheet within your app.","type":"text"}],"navigatorTitle":[{"text":"Button","kind":"identifier"}],"identifier":"doc:\/\/com.tpay.sdk\/documentation\/Tpay\/Payment\/Button"},"doc://com.tpay.sdk/documentation/Tpay/CardTokenization":{"type":"topic","title":"Card tokenization","role":"collectionGroup","abstract":[{"text":"Saving credit card details for future purchases.","type":"text"}],"identifier":"doc:\/\/com.tpay.sdk\/documentation\/Tpay\/CardTokenization","url":"\/documentation\/tpay\/cardtokenization","kind":"article"}},"variantOverrides":[{"patch":[{"op":"replace","path":"\/identifier\/interfaceLanguage","value":"occ"},{"op":"add","path":"\/topicSections","value":null},{"op":"replace","path":"\/seeAlsoSections","value":[{"title":"Use cases","generated":true,"identifiers":["doc:\/\/com.tpay.sdk\/documentation\/Tpay\/CardTokenization","doc:\/\/com.tpay.sdk\/documentation\/Tpay\/AutomaticPayments"],"anchor":"Use-cases"}]}],"traits":[{"interfaceLanguage":"occ"}]}]}